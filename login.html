<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Login - Vibe Tribe</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;600&display=swap" rel="stylesheet">

  <style>
    body { 
      font-family: 'Poppins', sans-serif; 
      background: linear-gradient(135deg, #f0f4ff, #e0f2fe); 
      margin:0; 
    }

    .container { 
      min-height:100vh; 
      display:flex; 
      align-items:center; 
      justify-content:center; 
      padding:20px; 
    }

    .box { 
      width:380px; 
      background:#fff; 
      border-radius:20px; 
      padding:30px 25px; 
      box-shadow:0 15px 35px rgba(0,0,0,0.1); 
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .box:hover {
      transform: translateY(-5px);
      box-shadow:0 20px 40px rgba(0,0,0,0.15);
    }

    .box h2 { 
      margin:0 0 20px; 
      font-weight:700; 
      color:#1e293b; 
      text-align:center; 
    }

    .note { 
      font-size:13px; 
      color:#64748b; 
      text-align:center; 
      margin-bottom:16px; 
    }

    input { 
      width:100%; 
      padding:14px; 
      margin:10px 0; 
      border:1px solid #cbd5e1; 
      border-radius:12px; 
      font-size:15px; 
      transition: border 0.3s ease, box-shadow 0.3s ease;
    }

    input:focus {
      outline:none;
      border-color:#2563eb;
      box-shadow:0 0 5px rgba(37,99,235,0.4);
    }

    button { 
      width:100%; 
      padding:14px; 
      margin-top:15px; 
      border:none; 
      border-radius:12px; 
      background: linear-gradient(90deg, #2563eb, #3b82f6); 
      color:#fff; 
      font-weight:600; 
      font-size:15px; 
      cursor:pointer; 
      transition: background 0.3s ease, transform 0.2s ease;
    }

    button:hover { 
      background: linear-gradient(90deg, #3b82f6, #2563eb); 
      transform: translateY(-2px); 
    }

    #recaptcha-container { 
      margin-top:10px; 
      display:flex; 
      justify-content:center; 
    }

    .small { 
      font-size:13px; 
      color:#64748b; 
      text-align:center; 
      margin-top:12px; 
    }

    /* OTP input smooth transition */
    #otp {
      display:none;
      opacity:0;
      transition: opacity 0.5s ease;
    }
    #otp.show {
      display:block;
      opacity:1;
    }

    #verifyBtn {
      display:none;
      opacity:0;
      transition: opacity 0.5s ease;
    }
    #verifyBtn.show {
      display:block;
      opacity:1;
    }

  </style>
</head>

<body>
<div class="container">
  <div class="box">
    <h2>Login to Vibe Tribe</h2>
    <p class="note">Enter your phone number. We will send an OTP to verify.</p>

    <input id="phone" placeholder="+91xxxxxxxxxx" value="+91" />
    <div id="recaptcha-container"></div>
    <button id="sendBtn">Send OTP</button>

    <input id="otp" placeholder="Enter OTP" />
    <button id="verifyBtn">Verify OTP</button>

    <p class="small">Need help? Contact admin.</p>
  </div>
</div>

<!-- Firebase v9 compat -->
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyCpr9MXotr-M7noA7G28irleItKUELCY8Q",
    authDomain: "vibe-tribe-d5138.firebaseapp.com",
    projectId: "vibe-tribe-d5138",
    storageBucket: "vibe-tribe-d5138.firebasestorage.app",
    messagingSenderId: "656217231234",
    appId: "1:656217231234:web:e19e5e41836c4893c9899b"
  };

  firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();
  window.recaptchaVerifier = new firebase.auth.RecaptchaVerifier('recaptcha-container', { size: 'invisible' });

  const phoneInput = document.getElementById("phone");
  const otpInput = document.getElementById("otp");
  const sendBtn = document.getElementById("sendBtn");
  const verifyBtn = document.getElementById("verifyBtn");
  let confirmationResult;

  sendBtn.onclick = function () {
    const phone = phoneInput.value.trim();
    if (!phone) return alert("Enter phone number");

    sendBtn.disabled = true;
    sendBtn.textContent = "Sending...";

    auth.signInWithPhoneNumber(phone, window.recaptchaVerifier)
      .then(res => {
        confirmationResult = res;
        otpInput.classList.add("show");
        verifyBtn.classList.add("show");
        sendBtn.style.display = "none";
        alert("OTP sent!");
      })
      .catch(err => {
        console.error(err);
        alert(err.message);
        sendBtn.disabled = false;
        sendBtn.textContent = "Send OTP";
      });
  };

  verifyBtn.onclick = function () {
    const code = otpInput.value.trim();
    if (!code) return alert("Enter OTP");

    verifyBtn.disabled = true;
    verifyBtn.textContent = "Verifying...";

    confirmationResult.confirm(code)
      .then(result => {
        alert("Login Success!");
        window.location.href = "index.html";
      })
      .catch(err => {
        alert("Invalid OTP");
        verifyBtn.disabled = false;
        verifyBtn.textContent = "Verify OTP";
      });
  };
</script>

</body>
</html>
